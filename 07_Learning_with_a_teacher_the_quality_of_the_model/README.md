# Проект: Обучение с учителем: качество модели

Задача: интернет-магазин «В один клик» хочет удерживать активность постоянных клиентов. Перед отделом цифровых технологий стоит задача разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

Для этого необходимо:
1. Разработать модель, которая предскажет вероятность снижения покупательской активности.
2. Выделить сегмент покупателей, проанализировать его и предложить, как увеличить его покупательскую активность. Для этого нужно использовать данные моделирования, данные о прибыли покупателей и исходные данные (если понадобятся).

Примеры сегментов:
* Группа клиентов с максимальной долей покупок по акции и высокой вероятностью снижения покупательской активности.
* Группа клиентов, которые покупают только технику, то есть товары с длинным жизненным циклом.
* Группа клиентов, которые покупают товары из категории «Товары для себя» (новая категория, которую можно выделить на основе текущих) или «Товары для детей».
* Группа клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью.

## *Итоговый вывод:*

В ходе анализа данных по активности постоянных клиентов интернет-магазина «В один клик». Была проделана следующая работа:
>Загрузка данных
Исходными данными для исследования были четыре отдельных csv файла:

с данными о поведении покупателя на сайте, коммуникации с ним и его продуктовом поведении.
с данными о выручке, которую получает магазин с покупателя за период
с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода
данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю Данные были загружены в датафреймы библиотеки pandas.

> Предобработка данных

в ходе работы была выполнена предобработка данных, удалены неявные дубликаты, одно аномальное значение приведено к среднему для пользователя.

> Исследовательский анализ данных

на этом этапе построены графики разпределения признаков. Были подчеркнуты особенности распределения некоторых признаков, например бимодальное распределение акционных покупок. Также выявлено большинство клиентов не резрешают сообщать информацию о том, можно ли присылать покупателю дополнительные предложения о товаре и имеют стандартный тип обслуживания.

> Корреляционный анализ данных

В ходе корреляционного анализа была построена матрица корреляции признаков. Сильной корреляции между другими признаками не было выявлено.

> Объеденение таблиц

Таблицы market_file, market_money, market_time были объеденены в один датафрейм.

> Обучение модели

На данном этапе была проверена работа известных моделей для классификации пользователей по покупательской активности KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и SVC(). Лучшей моделью в ходе исслдования выбрана Лонистическая Регрессия.

>Анализ важности признаков

С помощью библиотеки SHAP была визуализирована значимость признаков для лучшей модели. 

> Сегментация покупателей

В качестве сегмента для анализа была выбрана группа клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью. Выведены графики показывающие отличие исследуемого сегмента от остальной выборки и даны рекомендации.
