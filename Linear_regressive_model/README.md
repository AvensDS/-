# Проект по теме: Линейные модели в машинном обучении

В ходе выполнения данного проекта будет выполняться запрос владельца молочного хозяйства «Вольный луг», который хочет купить бурёнок, чтобы расширить поголовье стада коров. 

**Задача:**  разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. 

Для этого необходимо создать две прогнозные модели для отбора бурёнок в поголовье:
1. Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
2. Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).

Основные критерии: 
* средний удой за год — не менее 6000 килограммов;
* молоко должно быть вкусным.

# *Итоговые выводы:*

В ходе работы были исследованы данные, предоставленные фермером молочного хозяйства «Вольный луг», который хочет купить бурёнок, чтобы расширить поголовье стада коров. Пропусков данных не было обнаружено, удалены явные и исправлены неявные дубликаты.

Ходе обучения моделей линейной регрессии была обучена первая модель линейной регресси на иисходных данных таблицы ferma_main, после во второй модели были преобразованы данные признаков СПО в категориальный ЭКЕ возведена квадрат. Третья модель обучена с добавлением дополнительного признака имени папы быка. Результаты метрик трех моделей приведены ниже.

|metric|model_1|model_2|model_3|
|:-----|:-----|:-----|:-----|
|R2|0.815430|0.838117|0.853696|
|MAE|167.119826|156.104470|147.994499|
|MSE|43977.878364|38572.084504|34860.227991|
|RMSE|209.709033|196.397771|186.708939|

Для предсказания данных об удое была выбрана модель №3.

Для предсказания вкуса была обучена модель логистической регрессии. В данном случае в качестве основной метрики была выбрана precision для минимизации ошибок первого рода. Ничего страшного если модель не учтет корову с потенциально вкусным молоком, гораздо хуже если будет много ложно позитивных значений, в результате чего фермер купит корову, ее молоко окажется не вкусным, в следствие чего он потерпит убытки.

Перед предсказанием в таблицу cow_buy были добавлены недостающие признаки, увеличенные на 5%, модифицированные аналогичено второй модели линейной регресси. Точность модели оставляла желать лучшего, получилось так, скорее всего, из-за того что входные признаки имели слабую взаимосвязь с целевым. В таком случае стоило бы поискать чуть больше данных, которые бы сильнее коррелировали со вкусом молока.

Порогом классификации было выбрано значение 0.80. 

При после предсказания данных и их фильтрации в соответствиями с критериями заказщика было выбрано 2 коровы, которые удовлетваряли необходимым требованиям. Эта покупка с минимальным риском.
Если заказчик в некоторой cтепени допускает риск, то я бы оставил порог классиификации в 0.68 - это величина, при котором значение всех метрик для нашего случая оптимальное. Так получится выбрать больше коров. На валидационной выборке:
1. Accuracy - 0.55
2. Precision - 0.91
3. Recall - 0.29

Да, риск больше, но и потенциальных коров, которые можно купить, которые могу принести потенциальную прибыль в 1.5 раза больше. Можно еще снизить порог до 0.65, тогла коров будет 5.
